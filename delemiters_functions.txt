DELIMITER $$

CREATE FUNCTION C_PELICULA(P_ID INTEGER)
RETURNS VARCHAR(150)
DETERMINISTIC
BEGIN
    DECLARE V_PELICULA VARCHAR(150);

    SELECT titulo INTO V_PELICULA
    FROM peliculas
    WHERE id = P_ID;
    RETURN V_PELICULA;
END$$

DELIMITER;

CREATE FUNCTION C_SALA(P_ID INTEGER)
RETURNS VARCHAR(150)
DETERMINISTIC
BEGIN
    DECLARE V_SALA VARCHAR(150);

    SELECT nombre INTO V_SALA
    FROM salas
    WHERE id = P_ID;
    RETURN V_SALA;
END$$

DELIMITER;

DELIMITER $$

CREATE FUNCTION C_HORARIO(P_ID INTEGER)
RETURNS VARCHAR(150)
DETERMINISTIC
BEGIN
    DECLARE V_HORA VARCHAR(150);

    SELECT hora INTO V_HORA
    FROM horarios
    WHERE id = P_ID;
    RETURN V_HORA;
END$$

DELIMITER;

DELIMITER $$

CREATE FUNCTION C_TOTAL(P_ID INTEGER)
RETURNS INTEGER
DETERMINISTIC
BEGIN
    DECLARE V_TOTAL INTEGER;

    SELECT sum(peliculas.valorBoleto*compras.numero_boletos) as total INTO V_TOTAL
    FROM compras join sala_peliculas on sala_peliculas.id = compras.idsala_peliculas join peliculas on peliculas.id = sala_peliculas.idpelicula 
    group by peliculas.titulo
    WHERE id = P_ID;
    RETURN V_TOTAL;
END$$

DELIMITER;